# ==============================================================================
# Dropbox Clone Environment Variables
# ==============================================================================

# --- Infrastructure ---
# The port on the host where the Nginx container will be accessible.
DROPBOX_HOST_PORT=8100

# Base URL for the internal FileBrowser instance (within the Docker network).
DROPPR_FILEBROWSER_BASE_URL=http://app:80

# Redis connection string for caching and task queue.
DROPPR_REDIS_URL=redis://redis:6379/0

# Celery broker and backend (usually the same as Redis).
DROPPR_CELERY_BROKER_URL=redis://redis:6379/1
DROPPR_CELERY_RESULT_BACKEND=redis://redis:6379/1

# --- Security & Authentication ---
# Secret key for signing Droppr JWT tokens (Access and Refresh).
# Generate a strong one: openssl rand -base64 48
DROPPR_AUTH_SECRET=your_jwt_secret_here

# Time-to-live for access tokens in seconds.
# Back-compat: DROPPR_AUTH_TOKEN_TTL_SECONDS is also accepted.
DROPPR_AUTH_ACCESS_TTL_SECONDS=3600
DROPPR_AUTH_REFRESH_TTL_SECONDS=86400

# Admin TOTP (2FA) support.
DROPPR_ADMIN_TOTP_ENABLED=false
DROPPR_ADMIN_TOTP_SECRET=your_base32_secret_here

# Admin IP allowlist (comma-separated, CIDR supported).
DROPPR_ADMIN_IP_ALLOWLIST=

# Cloudflare Turnstile (CAPTCHA) credentials for public uploads.
DROPPR_CAPTCHA_SITE_KEY=
DROPPR_CAPTCHA_SECRET_KEY=

# Internal request signing secret (shared between Droppr and FileBrowser if enabled).
DROPPR_INTERNAL_SIGNING_KEY=

# --- Media Processing ---
# Maximum concurrent FFmpeg processes for thumbnails and proxies.
DROPPR_THUMB_MAX_CONCURRENCY=1
DROPPR_PROXY_MAX_CONCURRENCY=1

# Directories for cached media assets (internal to containers).
DROPPR_CACHE_DIR=/database/thumb-cache
DROPPR_PROXY_CACHE_DIR=/database/proxy-cache
DROPPR_HLS_CACHE_DIR=/database/hls-cache

# Cloudflare R2 Integration (Optional)
DROPPR_R2_ENABLED=false
DROPPR_R2_ENDPOINT=
DROPPR_R2_BUCKET=
DROPPR_R2_ACCESS_KEY_ID=
DROPPR_R2_SECRET_ACCESS_KEY=
DROPPR_R2_PUBLIC_BASE_URL=
DROPPR_R2_PREFIX=droppr-cache

# --- Upload Settings ---
# Comma-separated list of allowed extensions for public uploads.
DROPPR_UPLOAD_ALLOWED_EXTENSIONS=jpg,jpeg,png,gif,mp4,mov,pdf,zip,txt
# Maximum upload size in megabytes.
DROPPR_UPLOAD_MAX_SIZE_MB=500

# --- User Management ---
# Root directory for scoped user folders.
DROPPR_USER_ROOT=/users
# Base directory where user data is stored on disk.
DROPPR_USER_DATA_DIR=/srv
# Minimum password length for new scoped users.
DROPPR_USER_PASSWORD_MIN_LEN=12

# --- Analytics ---
# Enable or disable event logging.
DROPPR_ANALYTICS_ENABLED=true
# IP logging mode: 'full' or 'anonymized'.
DROPPR_ANALYTICS_IP_MODE=anonymized
# Number of days to keep analytics before archival.
DROPPR_ANALYTICS_RETENTION_DAYS=180

# Observability
DROPPR_LOG_FORMAT=json
DROPPR_LOG_LEVEL=INFO
DROPPR_SENTRY_DSN=
DROPPR_SENTRY_TRACES_SAMPLE_RATE=0.1
DROPPR_OTEL_ENABLED=false
DROPPR_OTEL_SERVICE_NAME=droppr-media-server
OTEL_EXPORTER_OTLP_ENDPOINT=http://collector:4317

# --- Secrets Management (Advanced) ---
# Path to a JSON file containing secrets (overrides environment variables).
DROPPR_SECRETS_FILE=
# AWS Secrets Manager support.
DROPPR_AWS_SECRETS_MANAGER_SECRET_ID=
DROPPR_AWS_REGION=us-east-1
# HashiCorp Vault support.
DROPPR_VAULT_ADDR=
DROPPR_VAULT_TOKEN=
DROPPR_VAULT_SECRET_PATH=
